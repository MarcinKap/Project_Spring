<head th:fragment="head_section" xmlns:th="http://www.thymeleaf.org" taglib prefix="security"
      uri="http://www.springframework.org/security/tags">

    <meta charset="UTF-8">
    <title>Project Spring</title>


    <base href="/"/>


    <!--</script>-->
    <link rel="stylesheet" href="styles.css">
    <script src="/static/functions.js"></script>


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">


    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Oleo+Script:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Teko:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Orbitron|Passion+One|Sacramento|Zhi+Mang+Xing&display=swap">
    <script src="https://kit.fontawesome.com/523af78209.js" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/523af78209.js" crossorigin="anonymous"></script>

    <script src="jquery-3.5.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!--    <link rel="stylesheet" href="styles=saving-ideas-creator-form.css">-->


    <!--        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"-->
    <!--                integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"-->
    <!--                crossorigin="anonymous"></script>-->
    <!--        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"-->
    <!--                integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"-->
    <!--                crossorigin="anonymous"></script>-->
    <!--        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">-->
    <!--        <link href="https://fonts.googleapis.com/css?family=Orbitron|Passion+One|Sacramento|Zhi+Mang+Xing&display=swap"-->
    <!--              rel="stylesheet">-->
    <!--    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->

    <!--        <script src="https://kit.fontawesome.com/523af78209.js" crossorigin="anonymous"></script>-->


    <!--        <script-->
    <!--                src="http://code.jquery.com/jquery-3.4.1.min.js"-->
    <!--                integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="-->
    <!--                crossorigin="anonymous"></script>-->

    <!--        <script src="https://unpkg.com/jquery"></script>-->
    <!--        <script src="https://surveyjs.azureedge.net/1.5.19/survey.jquery.js"></script>-->
    <!--        <link href="https://surveyjs.azureedge.net/1.5.19/survey.css" type="text/css" rel="stylesheet"/>-->


    <!--        &lt;!&ndash;Saving idea creator&ndash;&gt;-->
    <!--        <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">-->
    <!--        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>-->


    <!--    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">-->
    <!--    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">-->
    <!--    <link rel="stylesheet" href="build.css">-->

    <!--END-->


    <!--    CHECKBOXES-->


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>


    <!--    -->


    <!--    Przycisk wysylania wiadomosci bez reloadu-->
    <!--    <script type="text/javascript">-->
    <!--        $(function() {-->

    <!--            $('.vote').on('submit', function() {-->
    <!--                return false;-->
    <!--            });-->

    <!--        });-->
    <!--        </script>-->
    <!--    koniec-->


    <script>
        $(function () {
            // Sidebar toggle behavior
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar, #content').toggleClass('active');
            });
        });

        $(function () {
            $(window).on('scroll', function () {
                if ($(window).scrollTop() > 10) {
                    $('.navbar').addClass('active');
                } else {
                    $('.navbar').removeClass('active');
                }
            });
        });

        function loadSearchResult() {
            $.ajax({
                type: "GET",
                url: window.location + "",

                success: function (data) {

                    /*<![CDATA[*/


                    $('.proposals_list').html(data);


                    /*]]>*/
                },

            })

        }

        function updateProposal(id) {
            $.ajax({
                url: updateReadedParamById(id),
                success: function () {
                    updateProposalList();
                }
            })
        }

        //ZAPIS
        function updateReadedParamById(id) {
            $.post("/saveBook", {
                id: id
            });
        }

        //UPDATE ZAWARTOSCI
        function updateProposalList() {
            $.get("event-count").done(function (fragment) { // get from controller
                $("#eventCount").replaceWith(fragment); // update snippet of page
            });
        }

        
        function updateMessagesList(param) {
            setInterval(upd(param), 1000);
        }

        function upd(param) {
            $.get("show-messages", {friendId: param}).done(function (fragment) { // get from controller
                $("#showMessages").replaceWith(fragment); // update snippet of page
            });

            // setTimeout(updateMessagesList(param), 5000)
        }





        //WEBSOCKET
        var client = null;
        var color;
        const url = 'http://localhost:8080';


        function showMessage(value, user, userColor) {
            var newResponse = document.createElement('p');
            newResponse.style.color = userColor;
            newResponse.appendChild(document.createTextNode(user));
            newResponse.appendChild(document.createTextNode(": "));
            newResponse.appendChild(document.createTextNode(value));
            var respone = document.getElementById('reponse');
            respone.appendChild(newResponse);
        }

        function connect() {
            let socket = new SockJS(url + '/chat');

            client = Stomp.over(socket);
            color = getRandomColor();
            client.connect({}, function (frame) {
                client.subscribe("/topic/messages", function(message){
                    showMessage(JSON.parse(message.body).value, JSON.parse(message.body).user, JSON.parse(message.body).userColor)
                });
            })
        }

        function sendMessage() {
            var messageToSend = document.getElementById('messageToSend').value;
            var user = document.getElementById('user').value;
            client.send("/app/chat", {}, JSON.stringify({'value': messageToSend, 'user': user, 'userColor': color}) );
            document.getElementById('messageToSend').value = "";
        }

        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }


    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.0/handlebars.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.1.1/list.min.js"></script>
    <!--    libs for stomp and sockjs-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.4.0/sockjs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<!--    <script src="/static/websocket.js"></script>-->
    <script src="/templates/account-menu/stomp.js"></script>


    <!--    <script src="js/custom.js"></script>-->
    <!--    <script src="js/chat.js"></script>-->
    <!--    <script src="js/template.custom.js"></script>-->


</head>


